---
---
<div id="wrapper">

<h1>
	How to resolve a host name
</h1>

<!-- BEGIN Redirection Note -->
<p class="redirect-note">
  If got here by following a link such as <b>http://delphidabbler.com/tips/<em>999</em></b> (where <em>999</em> is a number) then you were re-directed because the tip is not yet available on the new delphidabbler.com website. <a href="https://delphidabbler.com/tips"><b>Go back to the delphidabbler.com tips page</b></a>
</p>
<!-- END OF Redirection Note -->

<p>
  Ever needed to convert a host name to an IP number? There is no direct
  routine available in Delphi for this but we can always code our way through
  :-)
</p>

<p>
  Here's the code with error handling:
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">uses</span>
  Winsock;
...
<span class="pas-comment">// The IP number will be returned in string format in the sIP parameter</span>
<span class="pas-kwd">function</span> HostToIP(sHost: <span class="pas-kwd">string</span>; <span class="pas-kwd">var</span> sIP: <span class="pas-kwd">string</span>): Boolean;
<span class="pas-kwd">var</span>
  aHostName: <span class="pas-kwd">array</span>[<span class="pas-num">0</span>..<span class="pas-num">255</span>] <span class="pas-kwd">of</span> Char;
  pcAddr   : PChar;
  HostEnt  : PHostEnt;
  wsData   : TWSAData;
<span class="pas-kwd">begin</span>
  WSAStartup(<span class="pas-hex">$0101</span>, wsData);
  <span class="pas-kwd">try</span>
    GetHostName(aHostName, SizeOf(aHostName));
    StrPCopy(aHostName, sHost);
    hostEnt := GetHostByName(aHostName);
    <span class="pas-kwd">if</span> Assigned(HostEnt) <span class="pas-kwd">then</span>
      <span class="pas-kwd">if</span> Assigned(HostEnt^.H_Addr_List) <span class="pas-kwd">then</span> <span class="pas-kwd">begin</span>
        pcAddr := HostEnt^.H_Addr_List^;
        <span class="pas-kwd">if</span> Assigned(pcAddr) <span class="pas-kwd">then</span> <span class="pas-kwd">begin</span>
          sIP := Format(<span class="pas-str">'%d.%d.%d.%d'</span>,
            [Byte(pcAddr[<span class="pas-num">0</span>]), Byte(pcAddr[<span class="pas-num">1</span>]),
            Byte(pcAddr[<span class="pas-num">2</span>]), Byte(pcAddr[<span class="pas-num">3</span>])]);
          Result := True;
        <span class="pas-kwd">end</span> <span class="pas-kwd">else</span>
          Result := False;
      <span class="pas-kwd">end</span> <span class="pas-kwd">else</span>
        Result := False
    <span class="pas-kwd">else</span> <span class="pas-kwd">begin</span>
      Result := False;
    <span class="pas-kwd">end</span>;
  <span class="pas-kwd">finally</span>
    WSACleanup;
  <span class="pas-kwd">end</span>;
<span class="pas-kwd">end</span>;</pre>
</div>

<table class="infotable">
  <tr>
    <th scope="row">Author:</th>
    <td>Unknown</td>
  </tr>
  <tr>
    <th scope="row">Added:</th>
    <td>2007-06-02</td>
  </tr>
  <tr>
    <th scope="row">Last updated:</th>
    <td>
    2007-06-02</td>
  </tr>
</table>



<div id="footer">
  Copyright &copy; Peter Johnson (<a href="https://gravatar.com/delphidabbler">DelphiDabbler</a>) 2002-2020
</div> <!-- #footer -->
</div> <!-- #wrapper -->
