---
---
<div id="wrapper">

<h1>
	How to read the installed ADO version
</h1>

<!-- BEGIN Redirection Note -->
<p class="redirect-note">
  If got here by following a link such as <b>http://delphidabbler.com/tips/<em>999</em></b> (where <em>999</em> is a number) then you were re-directed because the tip is not yet available on the new delphidabbler.com website. <a href="https://delphidabbler.com/tips"><b>Go back to the delphidabbler.com tips page</b></a>
</p>
<!-- END OF Redirection Note -->

<p>
  With different versions of MDAC available it is sometimes good to check
  whether the latest version is installed to make sure everything works fine.
  The following function returns the installed ADO version.
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">uses</span>
  ComObj;
<span class="pas-kwd">function</span> GetADOVersion: Double;
<span class="pas-kwd">var</span>
  ADO: OLEVariant;
<span class="pas-kwd">begin</span>
  <span class="pas-kwd">try</span>
    ADO := CreateOLEObject(<span class="pas-str">'adodb.connection'</span>);
    Result := StrToFloat(ADO.Version);
    ADO := null;
  <span class="pas-kwd">except</span>
    Result := <span class="pas-float">0.0</span>;
  <span class="pas-kwd">end</span>;
<span class="pas-kwd">end</span>;</pre>
</div>
<table class="infotable">
  <tr>
    <th scope="row">Author:</th>
    <td>Unknown</td>
  </tr>
  <tr>
    <th scope="row">Added:</th>
    <td>2007-06-02</td>
  </tr>
  <tr>
    <th scope="row">Last updated:</th>
    <td>
    2007-06-02</td>
  </tr>
</table>



<div id="footer">
  Copyright &copy; Peter Johnson (<a href="https://gravatar.com/delphidabbler">DelphiDabbler</a>) 2002-2020
</div> <!-- #footer -->
</div> <!-- #wrapper -->
