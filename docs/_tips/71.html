---
---
<div id="wrapper">

<h1>
	How to extract the title of an HTML document
</h1>

<!-- BEGIN Redirection Note -->
<p class="redirect-note">
  If got here by following a link such as <b>http://delphidabbler.com/tips/<em>999</em></b> (where <em>999</em> is a number) then you were re-directed because the tip is not yet available on the new delphidabbler.com website. <a href="https://delphidabbler.com/tips"><b>Go back to the delphidabbler.com tips page</b></a>
</p>
<!-- END OF Redirection Note -->

<p>
  Suppose you're writing a web browser using the Internet Explorer browser
  control and you want to display the title of the document in your program's
  title bar. You will need to be able to extract the loaded document's title
  from the HTML document itself. Here's how.
</p>

<p>
  Here's a function that will read the title from a HTML document.
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">function</span> GetHTMLDocTitle(<span class="pas-kwd">const</span> Doc: IDispatch): <span class="pas-kwd">string</span>;
<span class="pas-kwd">begin</span>
  <span class="pas-kwd">if</span> Supports(Doc, IHTMLDocument2) <span class="pas-kwd">then</span>
    Result := (Doc <span class="pas-kwd">as</span> IHTMLDocument2).title
  <span class="pas-kwd">else</span>
    Result := <span class="pas-str">''</span>;
<span class="pas-kwd">end</span>;</pre>
</div>

<p>
  Assuming we have have dropped a <var>TWebBrowser</var> control onto a Delphi
  form named <var>Form1</var>, we set the form's caption like this:
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source">Form1.Caption := GetHTMLDocTitle(WebBrowser1.Document);</pre>
</div>

<p>
  Note that this code assumes the required HTML document is already loaded
  into the browser control and that it has finished loading.
</p>

<p class="xref">
  See <a href="./72.html">Tip #72</a> to learn how to ensure the HTML document has loaded.
</p>
<table class="infotable">
  <tr>
    <th scope="row">Author:</th>
    <td>Peter Johnson</td>
  </tr>
  <tr>
    <th scope="row">Contributor:</th>
    <td>Peter Johnson</td>
  </tr>
  <tr>
    <th scope="row">Added:</th>
    <td>2009-06-17</td>
  </tr>
  <tr>
    <th scope="row">Last updated:</th>
    <td>
    2009-06-17</td>
  </tr>
</table>



<div id="footer">
  Copyright &copy; Peter Johnson (<a href="https://gravatar.com/delphidabbler">DelphiDabbler</a>) 2002-2020
</div> <!-- #footer -->
</div> <!-- #wrapper -->
