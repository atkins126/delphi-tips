<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Right align main menu items</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="Content-Language" content="en" />
<meta name="description" content="Right align main menu items" />
<meta name="keywords" content="programming, Delphi, hints, tips, hints and tips" />
<meta name="copyright" content="Copyright (c) 2002-2020 Peter D Johnson" />
<meta name="robots" content="INDEX,FOLLOW" />
<link rel="stylesheet" href="../css/main.css" />
<link rel="stylesheet" href="../css/main-multicol-scr.css" media="screen" />
<link rel="stylesheet" href="../css/main-2col-scr.css" media="screen" />
<script type="text/javascript" src="../js/core.js"></script>
<script type="text/javascript" src="../js/offsite-win.js"></script>
<link rel="stylesheet" href="../css/tips.css" />
<link rel="stylesheet" href="../css/source.css" />
</head>
<body>
<div id="wrapper">

<h1>
	Right align main menu items
</h1>

<p>
  In most applications all (top level) menu items are aligned at the left
  side of the menu bar. I'm sure you have seen applications with at least one
  item aligned on the right side. In most cases this was the &quot;Help&quot;
  menu item.
</p>

<ol>
  <li>
    Add a TMainMenu component to a form (Form1)
  </li>
  <li>
    Add several (top level) menu items (with sub items)
  </li>
  <li>
    Have a menu item named &quot;HelpMenuItem&quot;
  </li>
  <li>
    Use the code below in the form's <var>OnCreate</var> event.
  </li>
</ol>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">procedure</span><span class="pas-space"> </span><span class="pas-ident">TForm1</span><span class="pas-sym">.</span><span class="pas-ident">FormCreate</span><span class="pas-sym">(</span><span class="pas-ident">Sender</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TObject</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-sym">;</span>
<span class="pas-kwd">var</span>
<span class="pas-space">  </span><span class="pas-ident">mii</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TMenuItemInfo</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">MainMenu</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">hMenu</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">Buffer</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-kwd">array</span><span class="pas-sym">[</span><span class="pas-num">0</span><span class="pas-sym">..</span><span class="pas-num">79</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-kwd">of</span><span class="pas-space"> </span><span class="pas-ident">Char</span><span class="pas-sym">;</span>
<span class="pas-kwd">begin</span>
<span class="pas-space">  </span><span class="pas-ident">MainMenu</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">Self</span><span class="pas-sym">.</span><span class="pas-ident">Menu</span><span class="pas-sym">.</span><span class="pas-ident">Handle</span><span class="pas-sym">;</span>

<span class="pas-space">  </span><span class="pas-comment">//GET Help Menu Item Info</span>
<span class="pas-space">  </span><span class="pas-ident">mii</span><span class="pas-sym">.</span><span class="pas-ident">cbSize</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">SizeOf</span><span class="pas-sym">(</span><span class="pas-ident">mii</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">mii</span><span class="pas-sym">.</span><span class="pas-ident">fMask</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">MIIM_TYPE</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">mii</span><span class="pas-sym">.</span><span class="pas-ident">dwTypeData</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">Buffer</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">mii</span><span class="pas-sym">.</span><span class="pas-ident">cch</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">SizeOf</span><span class="pas-sym">(</span><span class="pas-ident">Buffer</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">GetMenuItemInfo</span><span class="pas-sym">(</span><span class="pas-ident">MainMenu</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">HelpMenuItem</span><span class="pas-sym">.</span><span class="pas-ident">Command</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">false</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">mii</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-sym">;</span>

<span class="pas-space">  </span><span class="pas-comment">//SET Help Menu Item Info</span>
<span class="pas-space">  </span><span class="pas-ident">mii</span><span class="pas-sym">.</span><span class="pas-ident">fType</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">mii</span><span class="pas-sym">.</span><span class="pas-ident">fType</span><span class="pas-space"> </span><span class="pas-kwd">or</span><span class="pas-space"> </span><span class="pas-ident">MFT_RIGHTJUSTIFY</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">SetMenuItemInfo</span><span class="pas-sym">(</span><span class="pas-ident">MainMenu</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">HelpMenuItem</span><span class="pas-sym">.</span><span class="pas-ident">Command</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">false</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">mii</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-sym">;</span>
<span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
</div>

<table class="infotable">
  <tr>
    <th scope="row">Author:</th>
    <td>Shlomo Abuisak</td>
  </tr>
  <tr>
    <th scope="row">Contributor:</th>
    <td>Shlomo Abuisak</td>
  </tr>
  <tr>
    <th scope="row">Added:</th>
    <td>2009-11-05</td>
  </tr>
  <tr>
    <th scope="row">Last updated:</th>
    <td>
    2009-11-05</td>
  </tr>
</table>



<div id="footer">
  Copyright &copy; Peter Johnson (<a href="https://gravatar.com/delphidabbler">DelphiDabbler</a>) 2002-2020
</div> <!-- #footer -->
</div> <!-- #wrapper -->
</body>
</html>
