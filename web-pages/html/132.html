<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Which COM objects to use?</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="Content-Language" content="en" />
<meta name="description" content="Which COM objects to use?" />
<meta name="keywords" content="programming, Delphi, hints, tips, hints and tips" />
<meta name="copyright" content="Copyright (c) 2002-2020 Peter D Johnson" />
<meta name="robots" content="INDEX,FOLLOW" />
<link rel="canonical" href="http://delphidabbler.com/tips/132" />
<link rel="stylesheet" href="/css/main.css" />
<link rel="stylesheet" href="/css/main-multicol-scr.css" media="screen" />
<link rel="stylesheet" href="/css/main-2col-scr.css" media="screen" />
<script type="text/javascript" src="/js/core.js"></script>
<script type="text/javascript" src="/js/offsite-win.js"></script>
<link rel="stylesheet" href="/css/tips.css" />
<script type="text/javascript" src="/js/popup-win.js"></script>
<script type="text/javascript" src="/js/show-hide.js"></script>
<link rel="alternate" href="/feeds/site-news-feed?id=tips" type="application/rss+xml" title="DelphiDabbler.com Tips News" />
<link rel="stylesheet" href="/css/source.css" />
<link rel="stylesheet" href="/css/js-detect.css" />
<script type="text/javascript" src="/js/js-detect.js"></script>
<script type="text/javascript">
  function showDemo(linkId, demoId) {
    showHide(linkId, demoId, 'Show demo code', 'Hide demo code');
  }
</script>
<!-- Begin Cookie Consent plugin by Silktide - http://silktide.com/cookieconsent -->
<script type="text/javascript">
    window.cookieconsent_options = {"message":"This site uses cookies to deliver its services, to enable targeted advertising and to support various social media buttons, and to analyse traffic. By using this site, you agree to its use of cookies.","dismiss":"Got it!","learnMore":"More info","link":"http://delphidabbler.com/subsid/cookies","theme":"dark-top"};
</script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js"></script>
<!-- End Cookie Consent plugin -->
</head>
<body>
<!-- Facebook script -->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div id="wrapper">
<div id="header">
<div class="hide-from-css">
<h1>DelphiDabbler.com</h1>
<p>Open source software, Delphi components, Tutorials &amp; more.</p>
</div> <!-- .hide-from-css -->
<div id="header-right">
<div id="quicklink" style="padding-right:4px;">
&raquo; <a href="/sitemap">Sitemap</a></div>
</div>
</div> <!-- #header -->
<div class="noprint" style="padding: 0 .5em .5em .5em; margin: .5em; background-color: #fcc;">
  <h2 class="smallcaps centre-align">
    &laquo;&laquo; Site Rescued &raquo;&raquo;
  </h2>
  <p class="highlight">
    While the site is still going to move from its current host, a new site will now take its place. <strong><a href="https://delphidabbler.blogspot.com/2020/03/delphidabblercom-is-no-longer-closing.html">More Info</a></strong>.
  </p>
  <p>
    The new site may have less content, but the core will now remain. And it will now play nicely with phones! Keep an eye on the <a href="https://delphidabbler.blogspot.com/">DelphiDabbler Blog</a> for news.
  </p>
</div>
<div id="navigation">
<hr class="hide-from-css" />
<h2 class="hide-from-css">Navigation</h2>
<ul>
<li><a href="/index">Home&nbsp;Page</a></li>
<li><a href="/programs">Programs</a></li>
<li><a href="/codelib">Delphi&nbsp;Library</a></li>
<li><a href="/snips-n-tips">Snippets&nbsp;&amp;&nbsp;Tips</a>
<ul>
<li class="sub-item"><a href="http://snippets.delphidabbler.com/" class="offsite-no-glyph">Code Snippets (Take 2)</a></li>
<li class="sub-item"><a href="/tips" class="selected ">Delphi&nbsp;Tips</a></li>
<li class="sub-item"><a href="http://swag.delphidabbler.com/" class="offsite-no-glyph">SWAG&nbsp;Archive</a></li>
</ul>
</li>
<li><a href="/articles">Articles</a></li>
<li><a href="http://wiki.delphidabbler.com/" class="offsite-no-glyph">Documentation</a></li>
<li><a href="/blog">Blog</a></li>
<li><a href="/news">News</a></li>
<li><a href="/contact">Contact</a></li>
<li><a href="/background">About</a></li>
</ul>
</div> <!-- #navigation -->
<div id="main">
<div id="content">
<span class="help noprint">&raquo <a href="/help/tips-help.html" class="js-popup">Help</a></span>
<h1>
	Which COM objects to use?
</h1>

<div class="noprint">
<!-- style in following div and non-breaking spaces are a work around for a
     rendering bug in IE7 that sometimes hides preceeding h1 section if nothing
     is printed before this show_ads.js code is run.
     Tested and runs OK on Safari, Opera, Firefox, Chrome, but then, so did the
     original code! -->
<div class="centre-align" style="font-size:1pt;">&nbsp;
<script type="text/javascript"><!--
google_ad_client = "ca-pub-0907703677935617";
/* 468x60, created 11/04/09 */
google_ad_slot = "8060165044";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
&nbsp;
</div>
</div>
<p>
  In many situations, it is necessary to enumerate the COM objects that can be
  used in a certain context. Furthermore we may need information about all COM
  objects that were specially developed to solve one particular problem.
</p>

<p>
  For example, we are in the middle of developing some COM based plug-in
  framework for our application. Surely this question will soon come up:
  &quot;What is the standard way to determine what plug-ins are available for
  a given host?&quot; Everytime the host app runs, it needs to find out its
  available (compatible) plug-ins.
</p>

<p>
  In Windows 98/2000 this is where Component Categories come to the rescue. In
  short, Component Categories are windows way to group several COM objects
  that shared some common functionality into one category. That way client
  applications can easily determine which COM objects are available to use.
  Just like interfaces, coclasses and other COM related stuff, each category
  is uniquely identified by a GUID (CATID - Category ID - to be precise.
</p>

<p>
  Windows defines two interfaces <var>ICatRegister</var> and
  <var>ICatInformation</var> to help developers use the Component Categories
  service. Both <var>ICatRegister</var> and <var>ICatInformation</var> are
  both implemented by a COM coclass defined by
  <var>CLSID_StdComponentCategoryMgr</var>. We use
  <var>ICatRegister.RegisterCategories</var> to register one or more
  categories. <var>RegisterCategories</var> receives two parameters. The first
  determines how many category will be registered and the second is the
  array (pointer) to <var>TCategoryInfo</var>. <var>TCategoryInfo</var> is
  defined as follows:
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-ident">TCategoryInfo</span><span class="pas-space"> </span><span class="pas-sym">=</span><span class="pas-space"> </span><span class="pas-kwd">record</span>
<span class="pas-space">  </span><span class="pas-ident">catid</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TGUID</span><span class="pas-sym">;</span><span class="pas-space"> </span><span class="pas-comment">// category ID</span>
<span class="pas-space">  </span><span class="pas-ident">lcid</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">UINT</span><span class="pas-sym">;</span><span class="pas-space">   </span><span class="pas-comment">// locale ID, for multi-language support</span>
<span class="pas-space">  </span><span class="pas-ident">szDescription</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-kwd">array</span><span class="pas-sym">[</span><span class="pas-num">0</span><span class="pas-sym">..</span><span class="pas-num">127</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-kwd">of</span><span class="pas-space"> </span><span class="pas-ident">WideChar</span><span class="pas-sym">;</span><span class="pas-space"> </span><span class="pas-comment">//category desc</span>
<span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
</div>

<p>
  To register one specified COM object (class) to one category we use
  <var>ICatRegister RegisterClassImplCategories</var>.
  <var>RegisterClassImplCategories</var> uses three parameters.
</p>

<ol>
  <li>
    The CLSID of the coclass that implement the category,
  </li>
  <li>
    The number of categories to be listed and
  </li>
  <li>
    the array of categories (<var>TCategoryInfo</var>) itself.
  </li>
</ol>

<p>
  Lastly, for the host application to scan all available COM objects that fit
  into one category, we use
  <var>ICatInformation.EnumClassesOfCategories</var>.
  <var>EnumClassesOfCategories</var> has five parameters, but we only use
  three of them. The first is to indicate which category we are interested in
  The second is the array of categories and the last is the CLSID/GUID
  enumerator of matching coclasses. The host application will use
  <var>GetImplementedClasses</var> to retrieve the CLSIDs of all COM objects
  that fit into the category provided. Notice that the code uses
  <var>TImplementedClasses</var> as a container for all CLSIDs retrieved.
  <var>TImplementedClasses</var> is defined simply as array of 256 CLSIDs. I
  Think that should be enough even for all extreme cases.
  <var>RegisterClassImplementation</var> with parameter <var>bRegister</var>
  set to True is used in the ActiveX DLL <var>DLLRegisterServer</var>
  function. This will register the category and the coclass that implements it
  in the Component Categories. <var>RegisterClassImplementation</var> with
  parameter <var>bRegister</var> set to False is used in the ActiveX DLL
  <var>DLLUnregisterServer</var> function will unregister the coclass that
  implements the given category.
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">unit</span><span class="pas-space"> </span><span class="pas-ident">uhdshake</span><span class="pas-sym">;</span>

<span class="pas-kwd">interface</span>

<span class="pas-kwd">uses</span>
<span class="pas-space">  </span><span class="pas-ident">Windows</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">ActiveX</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">ComObj</span><span class="pas-sym">;</span>

<span class="pas-kwd">type</span>
<span class="pas-space">  </span><span class="pas-ident">TImplementedClasses</span><span class="pas-space"> </span><span class="pas-sym">=</span><span class="pas-space"> </span><span class="pas-kwd">array</span><span class="pas-space"> </span><span class="pas-sym">[</span><span class="pas-num">0</span><span class="pas-sym">..</span><span class="pas-num">255</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-kwd">of</span><span class="pas-space"> </span><span class="pas-ident">TCLSID</span><span class="pas-sym">;</span>

<span class="pas-kwd">function</span><span class="pas-space"> </span><span class="pas-ident">GetImplementedClasses</span><span class="pas-sym">(</span><span class="pas-ident">CategoryInfo</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TCategoryInfo</span><span class="pas-sym">;</span><span class="pas-space"> </span>
<span class="pas-space">  </span><span class="pas-kwd">var</span><span class="pas-space"> </span><span class="pas-ident">ImplementedClasses</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TImplementedClasses</span><span class="pas-sym">)</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">integer</span><span class="pas-sym">;</span>

<span class="pas-kwd">procedure</span><span class="pas-space"> </span><span class="pas-ident">RegisterClassImplementation</span><span class="pas-sym">(</span>
<span class="pas-space">  </span><span class="pas-kwd">const</span><span class="pas-space"> </span><span class="pas-ident">CATID</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">CLSID</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TCLSID</span><span class="pas-sym">;</span><span class="pas-space"> </span><span class="pas-kwd">const</span><span class="pas-space"> </span><span class="pas-ident">sDescription</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-kwd">string</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">bRegister</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">boolean</span><span class="pas-sym">)</span><span class="pas-sym">;</span>

<span class="pas-kwd">implementation</span>

<span class="pas-kwd">function</span><span class="pas-space"> </span><span class="pas-ident">GetImplementedClasses</span><span class="pas-sym">(</span><span class="pas-ident">CategoryInfo</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TCategoryInfo</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-kwd">var</span><span class="pas-space"> </span><span class="pas-ident">ImplementedClasses</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TImplementedClasses</span><span class="pas-sym">)</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">integer</span><span class="pas-sym">;</span>
<span class="pas-kwd">var</span>
<span class="pas-space">  </span><span class="pas-ident">CatInfo</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">ICatInformation</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">Enum</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">IEnumGuid</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">Fetched</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">UINT</span><span class="pas-sym">;</span>
<span class="pas-kwd">begin</span>
<span class="pas-space">  </span><span class="pas-ident">Result</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-num">0</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">CatInfo</span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">CreateComObject</span><span class="pas-sym">(</span><span class="pas-ident">CLSID_StdComponentCategoryMgr</span><span class="pas-sym">)</span>
<span class="pas-space">    </span><span class="pas-kwd">as</span><span class="pas-space"> </span><span class="pas-ident">ICatInformation</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">OleCheck</span><span class="pas-sym">(</span>
<span class="pas-space">    </span><span class="pas-ident">CatInfo</span><span class="pas-sym">.</span><span class="pas-ident">EnumClassesOfCategories</span><span class="pas-sym">(</span><span class="pas-num">1</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-sym">@</span><span class="pas-ident">CategoryInfo</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-num">0</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-kwd">nil</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">Enum</span><span class="pas-sym">)</span>
<span class="pas-space">  </span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-kwd">if</span><span class="pas-space"> </span><span class="pas-sym">(</span><span class="pas-ident">Enum</span><span class="pas-space"> </span><span class="pas-sym">&lt;&gt;</span><span class="pas-space"> </span><span class="pas-kwd">nil</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-kwd">then</span>
<span class="pas-space">  </span><span class="pas-kwd">begin</span>
<span class="pas-space">    </span><span class="pas-ident">OleCheck</span><span class="pas-sym">(</span><span class="pas-ident">Enum</span><span class="pas-sym">.</span><span class="pas-ident">Reset</span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-space">    </span><span class="pas-ident">OleCheck</span><span class="pas-sym">(</span>
<span class="pas-space">      </span><span class="pas-ident">Enum</span><span class="pas-sym">.</span><span class="pas-ident">Next</span><span class="pas-sym">(</span><span class="pas-ident">High</span><span class="pas-sym">(</span><span class="pas-ident">ImplementedClasses</span><span class="pas-sym">)</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">ImplementedClasses</span><span class="pas-space"> </span><span class="pas-sym">[</span><span class="pas-num">1</span><span class="pas-sym">]</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">Fetched</span><span class="pas-sym">)</span>
<span class="pas-space">    </span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-space">    </span><span class="pas-ident">Result</span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">Fetched</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-kwd">end</span><span class="pas-sym">;</span>
<span class="pas-kwd">end</span><span class="pas-sym">;</span>

<span class="pas-kwd">procedure</span><span class="pas-space"> </span><span class="pas-ident">RegisterClassImplementation</span><span class="pas-sym">(</span><span class="pas-kwd">const</span><span class="pas-space"> </span><span class="pas-ident">CATID</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">CLSID</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TCLSID</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-kwd">const</span><span class="pas-space"> </span><span class="pas-ident">sDescription</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-kwd">string</span><span class="pas-sym">;</span><span class="pas-space"> </span><span class="pas-ident">bRegister</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">boolean</span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-kwd">var</span>
<span class="pas-space">  </span><span class="pas-ident">CatReg</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">ICatRegister</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">CategoryInfo</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TCategoryInfo</span><span class="pas-sym">;</span>
<span class="pas-kwd">begin</span>
<span class="pas-space">  </span><span class="pas-ident">CoInitialize</span><span class="pas-sym">(</span><span class="pas-kwd">nil</span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">CategoryInfo</span><span class="pas-sym">.</span><span class="pas-ident">CATID</span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">CATID</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">CategoryInfo</span><span class="pas-sym">.</span><span class="pas-ident">LCID</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">LOCALE_SYSTEM_DEFAULT</span><span class="pas-sym">;</span><span class="pas-space">  </span><span class="pas-comment">//dummy</span>
<span class="pas-space">  </span><span class="pas-ident">StringToWideChar</span><span class="pas-sym">(</span>
<span class="pas-space">    </span><span class="pas-ident">sDescription</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">CategoryInfo</span><span class="pas-sym">.</span><span class="pas-ident">szDescription</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">Length</span><span class="pas-sym">(</span><span class="pas-ident">sDescription</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-sym">+</span><span class="pas-space"> </span><span class="pas-num">1</span>
<span class="pas-space">  </span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">CatReg</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">CreateComObject</span><span class="pas-space"> </span><span class="pas-sym">(</span><span class="pas-ident">CLSID_StdComponentCategoryMgr</span><span class="pas-sym">)</span>
<span class="pas-space">    </span><span class="pas-kwd">as</span><span class="pas-space"> </span><span class="pas-ident">ICatRegister</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-kwd">if</span><span class="pas-space"> </span><span class="pas-sym">(</span><span class="pas-ident">bRegister</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-kwd">then</span>
<span class="pas-space">  </span><span class="pas-kwd">begin</span>
<span class="pas-space">    </span><span class="pas-ident">OleCheck</span><span class="pas-sym">(</span><span class="pas-ident">CatReg</span><span class="pas-sym">.</span><span class="pas-ident">RegisterCategories</span><span class="pas-space"> </span><span class="pas-sym">(</span><span class="pas-num">1</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-sym">@</span><span class="pas-ident">CategoryInfo</span><span class="pas-sym">)</span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-space">    </span><span class="pas-ident">OleCheck</span><span class="pas-sym">(</span>
<span class="pas-space">      </span><span class="pas-ident">CatReg</span><span class="pas-sym">.</span><span class="pas-ident">RegisterClassImplCategories</span><span class="pas-sym">(</span><span class="pas-ident">CLSID</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-num">1</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-sym">@</span><span class="pas-ident">CategoryInfo</span><span class="pas-sym">)</span>
<span class="pas-space">    </span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-kwd">end</span>
<span class="pas-space">  </span><span class="pas-kwd">else</span>
<span class="pas-space">  </span><span class="pas-kwd">begin</span>
<span class="pas-space">    </span><span class="pas-ident">OleCheck</span><span class="pas-sym">(</span>
<span class="pas-space">      </span><span class="pas-ident">CatReg</span><span class="pas-sym">.</span><span class="pas-ident">UnregisterClassImplCategories</span><span class="pas-sym">(</span><span class="pas-ident">CLSID</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-num">1</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-sym">@</span><span class="pas-ident">CategoryInfo</span><span class="pas-sym">)</span>
<span class="pas-space">    </span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-space">    </span><span class="pas-ident">DeleteRegKey</span><span class="pas-sym">(</span>
<span class="pas-space">      </span><span class="pas-str">'CLSID\'</span><span class="pas-space"> </span><span class="pas-sym">+</span><span class="pas-space"> </span><span class="pas-ident">GuidToString</span><span class="pas-space"> </span><span class="pas-sym">(</span><span class="pas-ident">CLSID</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-sym">+</span><span class="pas-space"> </span><span class="pas-str">'\'</span><span class="pas-space"> </span><span class="pas-sym">+</span><span class="pas-space"> </span><span class="pas-str">'Implemented Categories'</span>
<span class="pas-space">    </span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-kwd">end</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">CatReg</span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-kwd">nil</span><span class="pas-sym">;</span>
<span class="pas-space">  </span><span class="pas-ident">CoUninitialize</span><span class="pas-sym">;</span>
<span class="pas-kwd">end</span><span class="pas-sym">;</span>

<span class="pas-kwd">end</span><span class="pas-sym">.</span></pre>
</div>
<table class="infotable">
  <tr>
    <th scope="row">Author:</th>
    <td>Shlomo Abuisak</td>
  </tr>
  <tr>
    <th scope="row">Contributor:</th>
    <td>Shlomo Abuisak</td>
  </tr>
  <tr>
    <th scope="row">Added:</th>
    <td>2009-11-05</td>
  </tr>
  <tr>
    <th scope="row">Last updated:</th>
    <td>
    2009-11-05</td>
  </tr>
</table>

<div class="search noprint">
<form name="tipsSearchForm" id="tipsSearchForm" method="post" action="/tips">
<input class="text" type="text" name="txtSearch" id="txtSearch" value="" size="24" maxlength="80" />
<input class="button" type="submit" name="btnSearch" id="btnSearch" value="Search" />
</form>
</div>
<ul class="tip-nav noprint">
<li><a href="/tips/1">First</a></li>
<li><span class="spacer">...</span></li>
<li><a href="/tips/128">128</a></li>
<li><a href="/tips/129">129</a></li>
<li><a href="/tips/130">130</a></li>
<li><a href="/tips/131">131</a></li>
<li><span class="current">132</span></li>
<li><a href="/tips/133">133</a></li>
<li><a href="/tips/134">134</a></li>
<li><a href="/tips/135">135</a></li>
<li><a href="/tips/136">136</a></li>
<li><span class="spacer">...</span></li>
<li><a href="/tips/234">Last</a></li>
</ul>

<p class="centre-align noprint">
  &laquo; <a href="/tips">Return to contents</a> &raquo;
</p>

</div> <!-- #content -->
</div> <!-- #main -->
<div id="footer">
<div class="hide-from-css"><hr /></div> <!-- .hide-from-css -->
<a href="/copyright">Copyright</a> &copy; Peter Johnson (<a href="/background">DelphiDabbler</a>) 2002-2020</div> <!-- #footer -->
</div> <!-- #wrapper -->
</body>
</html>
