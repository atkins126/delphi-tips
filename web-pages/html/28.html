<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>How to check if the BDE is installed</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="Content-Language" content="en" />
<meta name="description" content="How to check if the BDE is installed" />
<meta name="keywords" content="programming, Delphi, hints, tips, hints and tips" />
<meta name="copyright" content="Copyright (c) 2002-2020 Peter D Johnson" />
<meta name="robots" content="INDEX,FOLLOW" />
<link rel="stylesheet" href="../css/main.css" />
<script type="text/javascript" src="../js/core.js"></script>
<script type="text/javascript" src="../js/offsite-win.js"></script>
<link rel="stylesheet" href="../css/tips.css" />
<link rel="stylesheet" href="../css/source.css" />
</head>
<body>
<div id="wrapper">

<h1>
	How to check if the BDE is installed
</h1>

<h2>
  Answer 1
</h2>

<p>
  Your application may use several approaches to databases depending on what
  is installed on the user's computer. Before you use the BDE you may want to
  check if it has been installed. If not then you may either ask the user to
  do so first, else just use something else. The function below (roughly a
  couple lines of code) checks for BDE presence.
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">uses</span>
  Bde;

<span class="pas-kwd">function</span> BDEInstalled: Boolean;
<span class="pas-kwd">begin</span>
  Result := (dbiInit(<span class="pas-kwd">nil</span>) = <span class="pas-num">0</span>);
<span class="pas-kwd">end</span>;</pre>
</div>

<p class="xref">
  A version of this function is available in the <a href="http://snippets.delphidabbler.com/" title="Off-site link" class="offsite">Code Snippets Database</a> as
  <a href="http://snippets.delphidabbler.com/list?snippets=CheckBDEInstalled" title="Off-site link" class="offsite">CheckBDEInstalled</a>.
</p>

<h2>
  Answer 2
</h2>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">function</span> isbdepresent: boolean;
<span class="pas-kwd">var</span>
  IdapiPath: <span class="pas-kwd">array</span>[<span class="pas-num">0</span>..<span class="pas-num">255</span>] <span class="pas-kwd">of</span> Char;
  IdapiHandle: THandle;
<span class="pas-kwd">begin</span>
  result := false;
  GetProfileString(<span class="pas-str">'IDAPI'</span>, <span class="pas-str">'DLLPath'</span>, <span class="pas-str">'C:\'</span>, IdapiPath, <span class="pas-num">255</span>);
  <span class="pas-comment">{next lines isolates the first directory path from the IdapiPath in</span>
<span class="pas-comment">  case there are more}</span>
  <span class="pas-kwd">if</span> Pos(<span class="pas-str">';'</span>, StrPas(IdapiPath)) &lt;&gt; <span class="pas-num">0</span> <span class="pas-kwd">then</span>
  <span class="pas-kwd">begin</span>
    StrPCopy(
    &#9;IdapiPath,
    &#9;Copy(StrPas(IdapiPath), <span class="pas-num">1</span>, Pred(Pos(<span class="pas-str">';'</span>, StrPas(IdapiPath))))
    );
  <span class="pas-kwd">end</span>;
  IdapiHandle := LoadLibrary(StrCat(IdapiPath, <span class="pas-str">'\IDAPI01.DLL'</span>));
  <span class="pas-kwd">if</span> IdapiHandle &lt; HINSTANCE_ERROR <span class="pas-kwd">then</span>
    result := false
    <span class="pas-comment">{IDAPI is not present on this system}</span>
  <span class="pas-kwd">else</span>
  <span class="pas-kwd">begin</span>
    FreeLibrary(IdapiHandle);
    result := true;
    <span class="pas-comment">{IDAPI is present on this system}</span>
  <span class="pas-kwd">end</span>;
<span class="pas-kwd">end</span>;</pre>
</div>

<p class="credits">
  Tip by Brian Bushay, formerly published on the defunct <em>Delphi Pool</em>
  web site.
</p>


<h2>
  Answer 3
</h2>

<p>
  Try to check the registry for the presence of the BDE:
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">with</span> TRegistry.create <span class="pas-kwd">do</span>
  <span class="pas-kwd">try</span>
    Rootkey := HKEY_LOCAL_MACHINE;
    OpenKey(<span class="pas-str">'SOFTWARE\BORLAND\DATABASE ENGINE'</span>, false);
    CFGFile := ReadString(<span class="pas-str">'CONFIGFILE01'</span>);
  <span class="pas-kwd">finally</span>
    Free;
  <span class="pas-kwd">end</span>;
<span class="pas-kwd">end</span>;</pre>
</div>

<p>
  The BDE is installed if CFGFile is not ''.
</p>

<p class="credits">
  Tip based on anonymous code formerly published on the defunct <em>Delphi
  Pool</em> web site.
</p>

<table class="infotable">
  <tr>
    <th scope="row">Author:</th>
    <td>Various</td>
  </tr>
  <tr>
    <th scope="row">Added:</th>
    <td>2007-06-02</td>
  </tr>
  <tr>
    <th scope="row">Last updated:</th>
    <td>
    2013-10-12</td>
  </tr>
</table>



<div id="footer">
  Copyright &copy; Peter Johnson (<a href="https://gravatar.com/delphidabbler">DelphiDabbler</a>) 2002-2020
</div> <!-- #footer -->
</div> <!-- #wrapper -->
</body>
</html>
