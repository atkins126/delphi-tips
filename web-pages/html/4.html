<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Calling CreateProcess() the easy way</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="Content-Language" content="en" />
<meta name="description" content="Calling CreateProcess() the easy way" />
<meta name="keywords" content="programming, Delphi, hints, tips, hints and tips" />
<meta name="copyright" content="Copyright (c) 2002-2020 Peter D Johnson" />
<meta name="robots" content="INDEX,FOLLOW" />
<link rel="stylesheet" href="../css/main.css" />
<link rel="stylesheet" href="../css/main-multicol-scr.css" media="screen" />
<link rel="stylesheet" href="../css/main-2col-scr.css" media="screen" />
<script type="text/javascript" src="../js/core.js"></script>
<script type="text/javascript" src="../js/offsite-win.js"></script>
<link rel="stylesheet" href="../css/tips.css" />
<link rel="stylesheet" href="../css/source.css" />
</head>
<body>
<div id="wrapper">

<h1>
	Calling CreateProcess() the easy way
</h1>

<p>
  If you look up the <var>CreateProcess()</var> function in Win32 help, you'll
  notice that there are more than three dozen parameters that you can
  optionally setup before calling it. The good news is that you have to setup
  only a small number of those parameters to make a simple
  <var>CreateProcess()</var> call as demonstrated in the following function:
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">function</span> CreateProcessSimple(sExecutableFilePath: <span class="pas-kwd">string</span> ): <span class="pas-kwd">string</span>;
<span class="pas-kwd">var</span>
  pi: TProcessInformation;
  si: TStartupInfo;
<span class="pas-kwd">begin</span>
  FillMemory(@si, sizeof(si), <span class="pas-num">0</span>);
  si.cb := sizeof(si);

  CreateProcess(
    <span class="pas-kwd">nil</span>,
    PChar( sExecutableFilePath ),     <span class="pas-comment">// path to the executable file:</span>
    <span class="pas-kwd">nil</span>, <span class="pas-kwd">nil</span>, False,
    NORMAL_PRIORITY_CLASS, <span class="pas-kwd">nil</span>, <span class="pas-kwd">nil</span>,
    si, pi
  );

  <span class="pas-comment">// &quot;after calling code&quot; such as</span>
  <span class="pas-comment">// the code to wait until the</span>
  <span class="pas-comment">// process is done should go here  </span>
  CloseHandle(pi.hProcess);
  CloseHandle(pi.hThread);
<span class="pas-kwd">end</span>;</pre>
</div>

<p>
  Now, all you have to do is call <var>CreateProcessSimple()</var>, let's say
  to run Windows' Notepad:
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source">CreateProcessSimple(<span class="pas-str">'notepad'</span>);</pre>
</div>
<table class="infotable">
  <tr>
    <th scope="row">Author:</th>
    <td>Unknown</td>
  </tr>
  <tr>
    <th scope="row">Added:</th>
    <td>2007-06-02</td>
  </tr>
  <tr>
    <th scope="row">Last updated:</th>
    <td>
    2007-06-02</td>
  </tr>
</table>



<div id="footer">
  Copyright &copy; Peter Johnson (<a href="https://gravatar.com/delphidabbler">DelphiDabbler</a>) 2002-2020
</div> <!-- #footer -->
</div> <!-- #wrapper -->
</body>
</html>
