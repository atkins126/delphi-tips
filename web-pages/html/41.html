<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Boyer-Moore-Horspool text searching</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="Content-Language" content="en" />
<meta name="description" content="Boyer-Moore-Horspool text searching" />
<meta name="keywords" content="programming, Delphi, hints, tips, hints and tips" />
<meta name="copyright" content="Copyright (c) 2002-2020 Peter D Johnson" />
<meta name="robots" content="INDEX,FOLLOW" />
<link rel="stylesheet" href="../css/main.css" />
<link rel="stylesheet" href="../css/main-multicol-scr.css" media="screen" />
<link rel="stylesheet" href="../css/main-2col-scr.css" media="screen" />
<script type="text/javascript" src="../js/core.js"></script>
<script type="text/javascript" src="../js/offsite-win.js"></script>
<link rel="stylesheet" href="../css/tips.css" />
<script type="text/javascript" src="../js/popup-win.js"></script>
<script type="text/javascript" src="../js/show-hide.js"></script>
<link rel="stylesheet" href="../css/source.css" />
<link rel="stylesheet" href="../css/js-detect.css" />
<script type="text/javascript" src="../js/js-detect.js"></script>
</head>
<body>
<div id="wrapper">

<h1>
	Boyer-Moore-Horspool text searching
</h1>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasHi -->
<div class="pas-source">
<pre class="line"><span class="pas-kwd">function</span><span class="pas-space"> </span><span class="pas-ident">search</span><span class="pas-sym">(</span><span class="pas-ident">pat</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-kwd">string</span><span class="pas-sym">;</span><span class="pas-space"> </span><span class="pas-ident">text</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-kwd">string</span><span class="pas-sym">)</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">integer</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-kwd">var</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">i</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">j</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">k</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">n</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">integer</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">skip</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-kwd">array</span><span class="pas-space"> </span><span class="pas-sym">[</span><span class="pas-num">0</span><span class="pas-sym">..</span><span class="pas-ident">MAXCHAR</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-kwd">of</span><span class="pas-space"> </span><span class="pas-ident">integer</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">found</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">boolean</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">found</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">FALSE</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">search</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-num">0</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">m</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">length</span><span class="pas-sym">(</span><span class="pas-ident">pat</span><span class="pas-sym">)</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">if</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">=</span><span class="pas-num">0</span><span class="pas-space"> </span><span class="pas-kwd">then</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">search</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-num">1</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">found</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">TRUE</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">for</span><span class="pas-space"> </span><span class="pas-ident">k</span><span class="pas-sym">:=</span><span class="pas-num">0</span><span class="pas-space"> </span><span class="pas-kwd">to</span><span class="pas-space"> </span><span class="pas-ident">MAXCHAR</span><span class="pas-space"> </span><span class="pas-kwd">do</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">skip</span><span class="pas-sym">[</span><span class="pas-ident">k</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">;</span><span class="pas-space">   </span><span class="pas-comment">{*** Preprocessing ***}</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">for</span><span class="pas-space"> </span><span class="pas-ident">k</span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">-</span><span class="pas-num">1</span><span class="pas-space"> </span><span class="pas-kwd">downto</span><span class="pas-space"> </span><span class="pas-num">1</span><span class="pas-space"> </span><span class="pas-kwd">do</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">skip</span><span class="pas-sym">[</span><span class="pas-ident">ord</span><span class="pas-sym">(</span><span class="pas-ident">pat</span><span class="pas-sym">[</span><span class="pas-ident">k</span><span class="pas-sym">]</span><span class="pas-sym">)</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">-</span><span class="pas-ident">k</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">k</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">n</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">length</span><span class="pas-sym">(</span><span class="pas-ident">text</span><span class="pas-sym">)</span><span class="pas-sym">;</span><span class="pas-space">            </span><span class="pas-comment">{*** Search ***}</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">while</span><span class="pas-space"> </span><span class="pas-kwd">not</span><span class="pas-space"> </span><span class="pas-ident">found</span><span class="pas-space"> </span><span class="pas-kwd">and</span><span class="pas-space"> </span><span class="pas-sym">(</span><span class="pas-ident">k</span><span class="pas-space"> </span><span class="pas-sym">&lt;=</span><span class="pas-space"> </span><span class="pas-ident">n</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-kwd">do</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">i</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">k</span><span class="pas-sym">;</span><span class="pas-space"> </span><span class="pas-ident">j</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-kwd">while</span><span class="pas-space"> </span><span class="pas-sym">(</span><span class="pas-ident">j</span><span class="pas-space"> </span><span class="pas-sym">&gt;=</span><span class="pas-space"> </span><span class="pas-num">1</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-kwd">do</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">if</span><span class="pas-space"> </span><span class="pas-ident">text</span><span class="pas-sym">[</span><span class="pas-ident">i</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-sym">&lt;&gt;</span><span class="pas-space"> </span><span class="pas-ident">pat</span><span class="pas-sym">[</span><span class="pas-ident">j</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-kwd">then</span></pre>
<pre class="line"><span class="pas-space">        </span><span class="pas-ident">j</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-sym">-</span><span class="pas-num">1</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">else</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">        </span><span class="pas-ident">j</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">j</span><span class="pas-sym">-</span><span class="pas-num">1</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">        </span><span class="pas-ident">i</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">i</span><span class="pas-sym">-</span><span class="pas-num">1</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">if</span><span class="pas-space"> </span><span class="pas-ident">j</span><span class="pas-space"> </span><span class="pas-sym">=</span><span class="pas-space"> </span><span class="pas-num">0</span><span class="pas-space"> </span><span class="pas-kwd">then</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">        </span><span class="pas-ident">search</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">i</span><span class="pas-sym">+</span><span class="pas-num">1</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">        </span><span class="pas-ident">found</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">TRUE</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-ident">k</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">k</span><span class="pas-space"> </span><span class="pas-sym">+</span><span class="pas-space"> </span><span class="pas-ident">skip</span><span class="pas-sym">[</span><span class="pas-ident">ord</span><span class="pas-sym">(</span><span class="pas-ident">text</span><span class="pas-sym">[</span><span class="pas-ident">k</span><span class="pas-sym">]</span><span class="pas-sym">)</span><span class="pas-sym">]</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
</div>
</div>

<div class="js-reveal-block">
  <p>
    <a
      id='demo-link'
      class='show-hide-link'
      href="javascript:void(0)"
      onclick="showDemo('demo-link', 'demo-code');"
    >Show demo code</a>
  </p>
  <div id="demo-code" class="demo-block">
    <p class="reporef">
      A ready made project containing this demo code is available.
      <a href="/view/repo/tip-041" title="Off-site link" class="offsite">View the project</a>.
    </p>
    <p>
      This demo will use the <var>search</var> function provided in this
      tip to search a memo control for text entered in an edit control.
    </p>
    <p>
      Create a new Delphi VCL application and proceed as follows:
    </p>
    <ul>
      <li>
        Drop a <var>TMemo</var> on the form and set its
        <var>HideSelection</var> property to <var>False</var> and its
        <var>ScrollBars</var> property to <var>ssVertical</var>. You can
        also enter some text in the memo's <var>Lines</var> property.
      </li>
      <li>
        Drop a <var>TEdit</var> and a <var>TButton</var> on the form.
      </li>
      <li>
        Create an <var>OnClick</var> event handler for the button.
      </li>
      <li>
        Name the form &quot;Form1&quot; and save the form unit as
        <code>Unit1.pas</code>.
      </li>
    </ul>
    <p>
      Now code <var>Unit1</var> as below:
    </p>
    <div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasHi -->
<div class="pas-source">
<pre class="line"><span class="pas-kwd">unit</span><span class="pas-space"> </span><span class="pas-ident">Unit1</span><span class="pas-sym">;</span></pre>
<pre class="line">&nbsp;</pre>
<pre class="line"><span class="pas-kwd">interface</span></pre>
<pre class="line">&nbsp;</pre>
<pre class="line"><span class="pas-kwd">uses</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">Windows</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">Forms</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">Dialogs</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">StdCtrls</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">Classes</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">Controls</span><span class="pas-sym">;</span></pre>
<pre class="line">&nbsp;</pre>
<pre class="line"><span class="pas-kwd">type</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">TForm1</span><span class="pas-space"> </span><span class="pas-sym">=</span><span class="pas-space"> </span><span class="pas-kwd">class</span><span class="pas-sym">(</span><span class="pas-ident">TForm</span><span class="pas-sym">)</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">Memo1</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TMemo</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">Edit1</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TEdit</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">Button1</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TButton</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-kwd">procedure</span><span class="pas-space"> </span><span class="pas-ident">Button1Click</span><span class="pas-sym">(</span><span class="pas-ident">Sender</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TObject</span><span class="pas-sym">)</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line">&nbsp;</pre>
<pre class="line"><span class="pas-kwd">var</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">Form1</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TForm1</span><span class="pas-sym">;</span></pre>
<pre class="line">&nbsp;</pre>
<pre class="line"><span class="pas-kwd">implementation</span></pre>
<pre class="line">&nbsp;</pre>
<pre class="line"><span class="pas-preproc">{$R *.dfm}</span></pre>
<pre class="line">&nbsp;</pre>
<pre class="line"><span class="pas-kwd">function</span><span class="pas-space"> </span><span class="pas-ident">search</span><span class="pas-sym">(</span><span class="pas-ident">pat</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-kwd">string</span><span class="pas-sym">;</span><span class="pas-space"> </span><span class="pas-ident">text</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-kwd">string</span><span class="pas-sym">)</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">integer</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-kwd">var</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">i</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">j</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">k</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">n</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">integer</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">skip</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-kwd">array</span><span class="pas-space"> </span><span class="pas-sym">[</span><span class="pas-num">0</span><span class="pas-sym">..</span><span class="pas-ident">MAXCHAR</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-kwd">of</span><span class="pas-space"> </span><span class="pas-ident">integer</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">found</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">boolean</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">found</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">FALSE</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">search</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-num">0</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">m</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">length</span><span class="pas-sym">(</span><span class="pas-ident">pat</span><span class="pas-sym">)</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">if</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">=</span><span class="pas-num">0</span><span class="pas-space"> </span><span class="pas-kwd">then</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">search</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-num">1</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">found</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">TRUE</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">for</span><span class="pas-space"> </span><span class="pas-ident">k</span><span class="pas-sym">:=</span><span class="pas-num">0</span><span class="pas-space"> </span><span class="pas-kwd">to</span><span class="pas-space"> </span><span class="pas-ident">MAXCHAR</span><span class="pas-space"> </span><span class="pas-kwd">do</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">skip</span><span class="pas-sym">[</span><span class="pas-ident">k</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">;</span><span class="pas-space">   </span><span class="pas-comment">{*** Preprocessing ***}</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">for</span><span class="pas-space"> </span><span class="pas-ident">k</span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">-</span><span class="pas-num">1</span><span class="pas-space"> </span><span class="pas-kwd">downto</span><span class="pas-space"> </span><span class="pas-num">1</span><span class="pas-space"> </span><span class="pas-kwd">do</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">skip</span><span class="pas-sym">[</span><span class="pas-ident">ord</span><span class="pas-sym">(</span><span class="pas-ident">pat</span><span class="pas-sym">[</span><span class="pas-ident">k</span><span class="pas-sym">]</span><span class="pas-sym">)</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">-</span><span class="pas-ident">k</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">k</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">n</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">length</span><span class="pas-sym">(</span><span class="pas-ident">text</span><span class="pas-sym">)</span><span class="pas-sym">;</span><span class="pas-space">            </span><span class="pas-comment">{*** Search ***}</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">while</span><span class="pas-space"> </span><span class="pas-kwd">not</span><span class="pas-space"> </span><span class="pas-ident">found</span><span class="pas-space"> </span><span class="pas-kwd">and</span><span class="pas-space"> </span><span class="pas-sym">(</span><span class="pas-ident">k</span><span class="pas-space"> </span><span class="pas-sym">&lt;=</span><span class="pas-space"> </span><span class="pas-ident">n</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-kwd">do</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">i</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">k</span><span class="pas-sym">;</span><span class="pas-space"> </span><span class="pas-ident">j</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">m</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-kwd">while</span><span class="pas-space"> </span><span class="pas-sym">(</span><span class="pas-ident">j</span><span class="pas-space"> </span><span class="pas-sym">&gt;=</span><span class="pas-space"> </span><span class="pas-num">1</span><span class="pas-sym">)</span><span class="pas-space"> </span><span class="pas-kwd">do</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">if</span><span class="pas-space"> </span><span class="pas-ident">text</span><span class="pas-sym">[</span><span class="pas-ident">i</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-sym">&lt;&gt;</span><span class="pas-space"> </span><span class="pas-ident">pat</span><span class="pas-sym">[</span><span class="pas-ident">j</span><span class="pas-sym">]</span><span class="pas-space"> </span><span class="pas-kwd">then</span></pre>
<pre class="line"><span class="pas-space">        </span><span class="pas-ident">j</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-sym">-</span><span class="pas-num">1</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">else</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">        </span><span class="pas-ident">j</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">j</span><span class="pas-sym">-</span><span class="pas-num">1</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">        </span><span class="pas-ident">i</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">i</span><span class="pas-sym">-</span><span class="pas-num">1</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">if</span><span class="pas-space"> </span><span class="pas-ident">j</span><span class="pas-space"> </span><span class="pas-sym">=</span><span class="pas-space"> </span><span class="pas-num">0</span><span class="pas-space"> </span><span class="pas-kwd">then</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">        </span><span class="pas-ident">search</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">i</span><span class="pas-sym">+</span><span class="pas-num">1</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">        </span><span class="pas-ident">found</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">TRUE</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">      </span><span class="pas-ident">k</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">k</span><span class="pas-space"> </span><span class="pas-sym">+</span><span class="pas-space"> </span><span class="pas-ident">skip</span><span class="pas-sym">[</span><span class="pas-ident">ord</span><span class="pas-sym">(</span><span class="pas-ident">text</span><span class="pas-sym">[</span><span class="pas-ident">k</span><span class="pas-sym">]</span><span class="pas-sym">)</span><span class="pas-sym">]</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line">&nbsp;</pre>
<pre class="line"><span class="pas-kwd">procedure</span><span class="pas-space"> </span><span class="pas-ident">TForm1</span><span class="pas-sym">.</span><span class="pas-ident">Button1Click</span><span class="pas-sym">(</span><span class="pas-ident">Sender</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">TObject</span><span class="pas-sym">)</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-kwd">var</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">FoundIdx</span><span class="pas-sym">:</span><span class="pas-space"> </span><span class="pas-ident">Integer</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-comment">// search() returns 0 if the text isn't found or the index of the</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-comment">// start of the string if the text is found</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-ident">FoundIdx</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">search</span><span class="pas-sym">(</span><span class="pas-ident">Edit1</span><span class="pas-sym">.</span><span class="pas-ident">Text</span><span class="pas-sym">,</span><span class="pas-space"> </span><span class="pas-ident">Memo1</span><span class="pas-sym">.</span><span class="pas-ident">Text</span><span class="pas-sym">)</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">if</span><span class="pas-space"> </span><span class="pas-ident">FoundIdx</span><span class="pas-space"> </span><span class="pas-sym">&gt;</span><span class="pas-space"> </span><span class="pas-num">0</span><span class="pas-space"> </span><span class="pas-kwd">then</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">begin</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-comment">// Found text: highlight it in memo (TMemo.HideSelection must be</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-comment">// false for this to work). Since memo selections are 0 based, we</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-comment">// subtract 1 from the found index, which is 1 based.</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">Memo1</span><span class="pas-sym">.</span><span class="pas-ident">SelStart</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">FoundIdx</span><span class="pas-space"> </span><span class="pas-sym">-</span><span class="pas-space"> </span><span class="pas-num">1</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">Memo1</span><span class="pas-sym">.</span><span class="pas-ident">SelLength</span><span class="pas-space"> </span><span class="pas-sym">:=</span><span class="pas-space"> </span><span class="pas-ident">Length</span><span class="pas-sym">(</span><span class="pas-ident">Edit1</span><span class="pas-sym">.</span><span class="pas-ident">Text</span><span class="pas-sym">)</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">end</span></pre>
<pre class="line"><span class="pas-space">  </span><span class="pas-kwd">else</span></pre>
<pre class="line"><span class="pas-space">    </span><span class="pas-ident">ShowMessage</span><span class="pas-sym">(</span><span class="pas-str">'Text not found'</span><span class="pas-sym">)</span><span class="pas-sym">;</span></pre>
<pre class="line"><span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
<pre class="line">&nbsp;</pre>
<pre class="line"><span class="pas-kwd">end</span><span class="pas-sym">.</span></pre>
</div>
    </div>
    <p>
      Run the application. Enter some text in the memo if you didn't do
      this at design time. Now enter some search text in the edit control
      and click the button. If the text is found it will be highlighted in
      the memo control. A message will be displayed if the text is not
      found. Note that the search is case sensitive.
    </p>
    <p class="credits">
      Demo code by Peter Johnson
    </p>
  </div>
</div>
<table class="infotable">
  <tr>
    <th scope="row">Author:</th>
    <td>Unknown</td>
  </tr>
  <tr>
    <th scope="row">Added:</th>
    <td>2007-06-11</td>
  </tr>
  <tr>
    <th scope="row">Last updated:</th>
    <td>
    2010-03-16</td>
  </tr>
</table>



<div id="footer">
  Copyright &copy; Peter Johnson (<a href="https://gravatar.com/delphidabbler">DelphiDabbler</a>) 2002-2020
</div> <!-- #footer -->
</div> <!-- #wrapper -->
</body>
</html>
