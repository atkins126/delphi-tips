<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<head>
<title>Drawing disabled text</title>
<meta http-equiv="Content-Language" content="en" />
<meta name="description" content="Drawing disabled text" />
<meta name="keywords" content="programming, Delphi, hints, tips, hints and tips" />
<meta name="copyright" content="Copyright (c) 2002-2020 Peter D Johnson" />
<meta name="robots" content="INDEX,FOLLOW" />
<link rel="stylesheet" href="../css/main.css" />
<script type="text/javascript" src="../js/core.js"></script>
<script type="text/javascript" src="../js/offsite-win.js"></script>
<link rel="stylesheet" href="../css/tips.css" />
<link rel="stylesheet" href="../css/source.css" />
</head>
<body>
<div id="wrapper">

<h1>
	Drawing disabled text
</h1>

<p>
  You can draw disabled text, like that you see when you set a
  <var>TLabel</var>'s <var>Enabled</var> property to false, by using the
  <var>DrawState</var> Windows API function.
</p>

<p>
  The following routine draws disabled text on a canvas using the canvas'
  current font:
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">function</span> DrawDisabledText(<span class="pas-kwd">const</span> Canvas: TCanvas; <span class="pas-kwd">const</span> X, Y: Integer;
  <span class="pas-kwd">const</span> Text: <span class="pas-kwd">string</span>): Boolean;
<span class="pas-kwd">begin</span>
  Result := DrawState(
    Canvas.Handle,            <span class="pas-comment">// device context to draw on</span>
    <span class="pas-num">0</span>,                        <span class="pas-comment">// brush (not required)</span>
    <span class="pas-kwd">nil</span>,                      <span class="pas-comment">// output function (not required)</span>
    Integer(PChar(Text)),     <span class="pas-comment">// text to be rendered</span>
    Length(Text),             <span class="pas-comment">// length of text to be rendered</span>
    X, Y,                     <span class="pas-comment">// co-ords of top left of text</span>
    <span class="pas-num">0</span>, <span class="pas-num">0</span>,                     <span class="pas-comment">// size of text (not required)</span>
    DST_TEXT <span class="pas-kwd">or</span> DSS_DISABLED  <span class="pas-comment">// text type and state</span>
  );
<span class="pas-kwd">end</span>;</pre>
</div>

<p>
  The <var>DST_TEXT</var> flag tells the API routine to display text and
  <var>DSS_DISABLED</var> tells it to draw the text disabled.
</p>

<p>
  If your text contains accelerator characters (i.e. uses the
  &quot;&amp;&quot; sign to cause the following character to display
  underlined), then use the <var>DST_PREFIXTEXT</var> flag in place of
  <var>DST_TEXT</var>.
</p>

<div class="xref">
  There is a version of <var>DrawDisabledText</var>, that can optionally handle accelerator characters, in the DelphiDabbler Code Snippets Database.
</div>

<h2>
  Example
</h2>

<p>
  In this example we will display the text &quot;Hello World!&quot; in the
  default font both normally (using <var>Canvas.TextOut</var>) and disabled
  (using <var>DrawDisabledText</var>).
</p>

<p>
  Start a new VCL application and create an OnPaint event handler for the form
  as follows:
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">procedure</span> TForm1.FormPaint(Sender: TObject);
<span class="pas-kwd">const</span>
  cText = <span class="pas-str">'Hello World!'</span>;
<span class="pas-kwd">begin</span>
  Canvas.TextOut(<span class="pas-num">8</span>, <span class="pas-num">8</span>, cText);
  DrawDisabledText(Canvas, <span class="pas-num">8</span>, <span class="pas-num">32</span>, cText);
<span class="pas-kwd">end</span>;</pre>
</div>

<p>
  If you want to use a different font, set the canvas' font property as
  required before calling <var>DrawDisabledText</var>. For example to change
  the above code to use 14pt Arial Bold, revise the <var>FormPaint</var>
  method as follows:
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">procedure</span> TForm1.FormPaint(Sender: TObject);
<span class="pas-kwd">const</span>
  cText = <span class="pas-str">'Hello World!'</span>;
<span class="pas-kwd">begin</span>
  Canvas.Font.Name := <span class="pas-str">'Arial'</span>;
  Canvas.Font.Size := <span class="pas-num">14</span>;
  Canvas.Font.Style := [fsBold];
  Canvas.TextOut(<span class="pas-num">8</span>, <span class="pas-num">8</span>, cText);
  DrawDisabledText(Canvas, <span class="pas-num">8</span>, <span class="pas-num">32</span>, cText);
<span class="pas-kwd">end</span>;</pre>
</div>

<table class="infotable">
  <tr>
    <th scope="row">Author:</th>
    <td>Peter Johnson</td>
  </tr>
  <tr>
    <th scope="row">Contributor:</th>
    <td>Peter Johnson</td>
  </tr>
  <tr>
    <th scope="row">Added:</th>
    <td>2007-10-15</td>
  </tr>
  <tr>
    <th scope="row">Last updated:</th>
    <td>
    2013-10-12</td>
  </tr>
</table>



<div id="footer">
  Copyright &copy; Peter Johnson (<a href="https://gravatar.com/delphidabbler">DelphiDabbler</a>) 2002-2020
</div> <!-- #footer -->
</div> <!-- #wrapper -->
</body>
</html>
