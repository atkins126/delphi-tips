<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Drawing outlined text</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="Content-Language" content="en" />
<meta name="description" content="Drawing outlined text" />
<meta name="keywords" content="programming, Delphi, hints, tips, hints and tips" />
<meta name="copyright" content="Copyright (c) 2002-2020 Peter D Johnson" />
<meta name="robots" content="INDEX,FOLLOW" />
<link rel="stylesheet" href="../css/main.css" />
<script type="text/javascript" src="../js/core.js"></script>
<script type="text/javascript" src="../js/offsite-win.js"></script>
<link rel="stylesheet" href="../css/tips.css" />
<link rel="stylesheet" href="../css/source.css" />
</head>
<body>
<div id="wrapper">

<h1>
	Drawing outlined text
</h1>

<p>
  We can draw outlined and filled text providing we are using a vector font.
  The following routine draws text on a canvas and outlines it with the
  canvas' current pen and fills it with the current brush.
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">procedure</span> DrawTextOutline(<span class="pas-kwd">const</span> Canvas: TCanvas; <span class="pas-kwd">const</span> X, Y: Integer;
  <span class="pas-kwd">const</span> Text: <span class="pas-kwd">string</span>);
<span class="pas-kwd">var</span>
  OldBkMode: Integer;  <span class="pas-comment">// stores previous background mode</span>
<span class="pas-kwd">begin</span>
  OldBkMode := SetBkMode(Canvas.Handle, TRANSPARENT);
  BeginPath(Canvas.Handle);
  Canvas.TextOut(X, Y, Text);
  EndPath(Canvas.Handle);
  StrokeAndFillPath(Canvas.Handle);
  SetBkMode(Canvas.Handle, OldBkMode);
<span class="pas-kwd">end</span>;</pre>
</div>

<p>
  First of all we set the background mode to transparent so that the bounding
  rectangle of the text is not filled with the canvas' current brush. Next we
  render the text as a Windows path (between <var>BeginPath</var> and
  <var>EndPath</var> API calls. If we left it at that nothing would be drawn
  on our canvas. The following call to <var>StrokeAndFillPath</var> outlines
  the path we have just created in the current pen and fills it with the
  current brush. Finally, the old background mode is restored.
</p>

<div class="xref">
  There is a version of <a href="http://snippets.delphidabbler.com/list?snippets=DrawTextOutline" title="Off-site link" class="offsite">DrawTextOutline</a>  in the <a href="http://snippets.delphidabbler.com/" title="Off-site link" class="offsite">Code Snippets Database</a>.
</div>

<h2>
  Example
</h2>

<p>
  In this example we will display the text &quot;Hello World!&quot; in a large
  true type font and draw it with a dark blue dotted outline and a light blue
  hatched interior.
</p>

<p>
  Start a new VCL application and create an <var>OnPaint</var> for the form as
  follows:
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">procedure</span> TForm1.FormPaint(Sender: TObject);
<span class="pas-kwd">const</span>
  cText = <span class="pas-str">'Hello World!'</span>;
<span class="pas-kwd">begin</span>
  Canvas.Font.Name := <span class="pas-str">'Comic Sans MS'</span>;
  Canvas.Font.Style := [fsBold];
  Canvas.Font.Size := <span class="pas-num">48</span>;
  Canvas.Brush.Color := clSkyBlue;  <span class="pas-comment">// $F0CAA6</span>
  Canvas.Brush.Style := bsDiagCross;
  Canvas.Pen.Color := clNavy;
  Canvas.Pen.Style := psDot;
  DrawTextOutline(Canvas, <span class="pas-num">0</span>, <span class="pas-num">0</span>, cText);
<span class="pas-kwd">end</span>;</pre>
</div>

<p>
  It looks a bit dull having a window-coloured background. We can change that
  by drawing the text twice. Change <var>FormPaint</var> as follows:
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">procedure</span> TForm1.FormPaint(Sender: TObject);
<span class="pas-kwd">const</span>
  cText = <span class="pas-str">'Hello World!'</span>;
<span class="pas-kwd">begin</span>
  Canvas.Font.Name := <span class="pas-str">'Comic Sans MS'</span>;
  Canvas.Font.Style := [fsBold];
  Canvas.Font.Size := <span class="pas-num">48</span>;
  <span class="pas-comment">// begin added code</span>
  Canvas.Brush.Color := clWhite;
  Canvas.Pen.Style := psClear;
  DrawTextOutline(Canvas, <span class="pas-num">0</span>, <span class="pas-num">0</span>, cText);
  <span class="pas-comment">// end added code</span>
  Canvas.Brush.Color := clSkyBlue;  <span class="pas-comment">// $F0CAA6</span>
  Canvas.Brush.Style := bsDiagCross;
  Canvas.Pen.Color := clNavy;
  Canvas.Pen.Style := psDot;
  DrawTextOutline(Canvas, <span class="pas-num">0</span>, <span class="pas-num">0</span>, cText);
<span class="pas-kwd">end</span>;</pre>
</div>

<p>
  Now we first paint the text with no border and a white background before
  overpainting the text with the dotted navy pen and light blue hatching.
</p>

<table class="infotable">
  <tr>
    <th scope="row">Author:</th>
    <td>Peter Johnson</td>
  </tr>
  <tr>
    <th scope="row">Contributor:</th>
    <td>Peter Johnson</td>
  </tr>
  <tr>
    <th scope="row">Added:</th>
    <td>2007-10-15</td>
  </tr>
  <tr>
    <th scope="row">Last updated:</th>
    <td>
    2013-10-12</td>
  </tr>
</table>



<div id="footer">
  Copyright &copy; Peter Johnson (<a href="https://gravatar.com/delphidabbler">DelphiDabbler</a>) 2002-2020
</div> <!-- #footer -->
</div> <!-- #wrapper -->
</body>
</html>
