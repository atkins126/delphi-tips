<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<head>
<title>How to extract the title of an HTML document</title>
<meta http-equiv="Content-Language" content="en" />
<meta name="description" content="How to extract the title of an HTML document" />
<meta name="keywords" content="programming, Delphi, hints, tips, hints and tips" />
<meta name="copyright" content="Copyright (c) 2002-2020 Peter D Johnson" />
<meta name="robots" content="INDEX,FOLLOW" />
<link rel="stylesheet" href="../css/main.css" />
<script type="text/javascript" src="../js/core.js"></script>
<script type="text/javascript" src="../js/offsite-win.js"></script>
<link rel="stylesheet" href="../css/tips.css" />
<link rel="stylesheet" href="../css/source.css" />
</head>
<body>
<div id="wrapper">

<h1>
	How to extract the title of an HTML document
</h1>

<p>
  Suppose you're writing a web browser using the Internet Explorer browser
  control and you want to display the title of the document in your program's
  title bar. You will need to be able to extract the loaded document's title
  from the HTML document itself. Here's how.
</p>

<p>
  Here's a function that will read the title from a HTML document.
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source"><span class="pas-kwd">function</span> GetHTMLDocTitle(<span class="pas-kwd">const</span> Doc: IDispatch): <span class="pas-kwd">string</span>;
<span class="pas-kwd">begin</span>
  <span class="pas-kwd">if</span> Supports(Doc, IHTMLDocument2) <span class="pas-kwd">then</span>
    Result := (Doc <span class="pas-kwd">as</span> IHTMLDocument2).title
  <span class="pas-kwd">else</span>
    Result := <span class="pas-str">''</span>;
<span class="pas-kwd">end</span>;</pre>
</div>

<p>
  Assuming we have have dropped a <var>TWebBrowser</var> control onto a Delphi
  form named <var>Form1</var>, we set the form's caption like this:
</p>

<div class="frame">
<!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
<pre class="pas-source">Form1.Caption := GetHTMLDocTitle(WebBrowser1.Document);</pre>
</div>

<p>
  Note that this code assumes the required HTML document is already loaded
  into the browser control and that it has finished loading.
</p>

<p class="xref">
  See <a href="/tips/72">Tip #72</a> to learn how to ensure the HTML document has loaded.
</p>
<table class="infotable">
  <tr>
    <th scope="row">Author:</th>
    <td>Peter Johnson</td>
  </tr>
  <tr>
    <th scope="row">Contributor:</th>
    <td>Peter Johnson</td>
  </tr>
  <tr>
    <th scope="row">Added:</th>
    <td>2009-06-17</td>
  </tr>
  <tr>
    <th scope="row">Last updated:</th>
    <td>
    2009-06-17</td>
  </tr>
</table>



<div id="footer">
  Copyright &copy; Peter Johnson (<a href="https://gravatar.com/delphidabbler">DelphiDabbler</a>) 2002-2020
</div> <!-- #footer -->
</div> <!-- #wrapper -->
</body>
</html>
